# -*- coding: utf-8 -*-
"""Project 85.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1yYkLbK9FW9Myl-2Wwa8d5exFeauwIeIY

### Instructions

#### Goal of the Project
This project is designed for you to practice and solve the activities that are based on the concepts covered in the lesson:

- Support Vector Machines - Introduction

- Support Vector Machines - Margins

---

#### Problem Statement

In this project, you are going to revise the lesson by visualising the support vectors and margins for the data created.

---

#### Getting Started:

1. Click on this link to open the Colab file for this project.

     https://colab.research.google.com/drive/194_AVriixVkBbz0rwNxP1qSZMzznIEBs   

2. Create a duplicate copy of the Colab file as described below.

  - Click on the **File menu**. A new drop-down list will appear.

   <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/lesson-0/0_file_menu.png' width=500>

  - Click on the **Save a copy in Drive** option. A duplicate copy will get created. It will open up in the new tab on your web browser.

  <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/lesson-0/1_create_colab_duplicate_copy.png' width=500>

3. After creating the duplicate copy of the notebook, please rename it in the **YYYY-MM-DD_StudentName_Project85** format.

4. Now, write your code in the prescribed code cells.

---

### Activities


**Activity 1:** Create and Visualise the Dummy Dataset

**Activity 2:** Support Vector Classifier - Model Training

**Activity 3:** Create Visualisation for Margins of the Model

---

#### Activity 1: Create and Visualise the Dummy Dataset

In this activity, you have to execute the code cell to create a dummy dataset for binary classification using the `make_circles()` function and visualize the same.

The basic syntax for the `make_circles()` function in the `sklearn.datasets` module is:

>**Syntax:** `make_circles(n_samples, noise, factor)`

Where,
- `n_samples`: Represent the number of data points.
- `noise`: Represents the standard deviation between two classes in the range (0, 1).
- `factor`: Represents scale factor between inner and outer circle in the range (0, 1).
Here the data should be with `X` as features array with 500 rows and 2 columns and `y` as target array with 500 rows classified into 2 labels.



The steps to be followed are:

**1.** Execute the below code section to create the dummy dataset for classification:
"""

# Run this code cell to generate dummy data using 'make_circle()' function

# Importing the library
from sklearn.datasets import make_circles
import pandas as pd

# Data creation
X, y = make_circles(500, factor=.4, noise=.1)

# Print the type of features array 'X' and target array 'y'
print(f"The features array is an {type(X)} object.\nThe target array is an {type(y)} object.\n")

# Print the number of rows and column of features array 'X'
print(f"The features array has {X.shape[0]} rows and {X.shape[1]} columns.")

# Print the number of rows and column of target array 'y'
print(f"The target array has {y.shape} rows and 1 column.")

"""In the above code, a dummy dataset is created having two columns representing two independent variables and a third column representing the target.

---

**2.** Print the number of occurrences of each label in `y` target array:
"""

# Display the number of occurrences of each label in the 'y' array\
import pandas as pd
pd.Series(y).value_counts()

"""**Q:** Which labels are created to classify the data points? Also mention the number of data points in each label.

**A:** Label `1 and 0` are created to classify the data points and they contain 250 data points each.

---

**3.** Visualise the synthetic data:

Create a scatter plot between the two columns of  features array `X` and differentiate the data points using the labels in the `y` array:
"""

# Create a scatter plot to visualise the synthetic data.
# Import the library
import warnings
warnings.filterwarnings('ignore')
import matplotlib.pyplot as plt
import seaborn as sns
# Create the scatter plot
plt.figure(figsize=(8,6),dpi = 96)
sns.scatterplot(X[:,0],X[:,1],hue=y)
plt.show()

"""**Q:** Determine whether the decision surface for the classification of data points is linear or non-linear.

**A:** Non-linear


**Q:** Which kernel is required for creating the above guessed decision surface for the classification of data points?

**A:** `rbf`kernel is required for creating the above guessed decision surface for the classification of data points

**After this activity, the following points should be concluded:**

**1.** **The labels should be identified**

**2.** **The data points should be visualized**

**3.** **The type of decision surface required for the classification should be estimated.**

---

####Activity 2: Support Vector Classifier - Model Training

Create a new SVM classification model using the independent features array `X` and target array `y` which will classify the data points into different labels.

The steps to be followed are :

*(Learned in "Activity 4: Model Building & Kernel Trick" of "Support Vector Machines - Introduction" lesson)*

**1.** Deploy the model by importing the `SVC` class and create an object of this class using an appropriate kernel.

**2.** Call the `fit()` function on the SVC object and print the score using the `score()` function:
"""

# Create an SVC model with appropriate kernel for classification and print the accuracy of the model
# Import the library
from sklearn.svm import SVC

# Create an object for the classification model
svc_model = SVC(kernel = 'rbf')

# Train the model
svc_model.fit(X,y)

# Print the accuracy score
print(svc_model.score(X,y))

print("**"*10)
# Print the model object
print(svc_model)

"""**3.** Print the number of support vectors for the model:"""

# Print the number of support vectors for data trained for model .
print(svc_model.n_support_)
print(svc_model.n_support_[0])
print(svc_model.n_support_[1])

"""**Q:** Write the total number of support vectors and the number of support vectors for each label.

**A:** Total number of support vectors = [25 24]. Number of support vectors for label 0 is 25 and for label 1 is 24.

---

**4.** Create a scatter plot to visualize the support vectors amongst the data points:
"""

# Create a scatter plot between the feature array columns
# to observe the support vectors amongst the data points
plt.figure(figsize=(10,5))

# Create a scatter plot for all the data points
sns.scatterplot(X[:,0],X[:,1],hue=y)
# Create the scatter plot for the support vectors,
sns.scatterplot(svc_model.support_vectors_[:,0],svc_model.support_vectors_[:,1],hue=svc_model.support_,cmap= 'Accent_r')
plt.show()

"""**Hint:**
*(Learned in "Support Vector Machines - Margins"  lesson)*

1. To find the values of support vectors, we use the `support_` attribute.
2. We can differentiate between the data points and support vectors we can create another scatter plot and use a different colour palette like `'Accent_r'`.

**After this activity, the classification model should be trained and support vectors should be identified and visualised.**

---

#### Activity 3: Create Visualisation for Margins of the Model

In this activity, you have to create the margins used for the classification of the data points.

**Steps:**

 *(Learned in "Support Vector Machines - Margins"  lesson)*
1. Define the size of the graph using the `figure()` function and get the current axes of the graph to save as a graph object.

2. Create the scatter plot for all data points using `matplotlib.pyplot` object.

3. Get the lower and upper limit of the x and y axes using the graph object.

4. Create 1D arrays for the x and y axes using the lower and upper limits.

5. Create a mesh grid using the 1D arrays to create 2D arrays.

6. Create a vertical stack using the 2D arrays.

7. Call the `decision_function()` function on the classification object and pass the vertical stack `xy` as input. Transpose the output and save the confidence value array in the `Z` variable.

8. Create a contour for the margins.

9. Create the scatter plot for the support vectors.

10. Display the colorbar.

11. Display the graph.
"""

# Create the margin visualisation for the SVC classification for class '0' and '1'.
# Import the library
import numpy as np
import matplotlib.pyplot as plt
# Create the graph object
plt.figure(figsize=(10,8),dpi= 96)
ax = plt.gca()

# Create the scatter plot for feature array columns using the given customization
plt.scatter(X[:,0],X[:,1],c=y,s= 50,cmap = 'Accent_r')

# Get the lower and upper limits form the graph object
xlim = ax.get_xlim()
ylim = ax.get_ylim()

# Create the 1D arrays of 50 items for mesh grid using lower and upper limits
x_ax=np.linspace(xlim[0],xlim[1],50)
y_ax=np.linspace(ylim[0],ylim[1],50)
# Create the mesh grid from the 1D arrays
xx,yy=np.meshgrid(x_ax,y_ax)
# Create the vertical array using the 2D arrays of mesh grid
xy=np.vstack([xx.ravel(),yy.ravel()]).T

# Create the class prediction confidence array for vertical arrays
zz = svc_model.decision_function(xy).reshape(xx.shape)

# Create the contour lines for the hyperplane and margin
ax.contourf(xx,yy,zz,alpha=0.3)

# Create the scatter plot for the support vectors
ax.scatter(svc_model.support_vectors_[:,0],svc_model.support_vectors_[:,1])

# Display the colorbar
plt.colorbar()
# Display the graph
plt.show()

"""**Q:** What is the shape of the margins created?

**A:** Circular

**Q:** In the visualisation, are the points classified accurately?

**A:** Yes

**After this activity, the margins should be visualised using the classification model created.**

---

### Submitting the Project

1. After finishing the project, click on the **Share** button on the top right corner of the notebook. A new dialog box will appear.

  <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/project-share-images/2_share_button.png' width=500>

2. In the dialog box, make sure that '**Anyone on the Internet with this link can view**' option is selected and then click on the **Copy link** button.

   <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/project-share-images/3_copy_link.png' width=500>

3. The link of the duplicate copy (named as **YYYY-MM-DD_StudentName_Project85**) of the notebook will get copied.

   <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/project-share-images/4_copy_link_confirmation.png' width=500>

4. Go to your dashboard and click on the **My Projects** option.
   
   <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/project-share-images/5_student_dashboard.png' width=800>

  <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/project-share-images/6_my_projects.png' width=800>

5. Click on the **View Project** button for the project you want to submit.

   <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/project-share-images/7_view_project.png' width=800>

6. Click on the **Submit Project Here** button.

   <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/project-share-images/8_submit_project.png' width=800>

7. Paste the link to the project file named as **YYYY-MM-DD_StudentName_Project85** in the URL box and then click on the **Submit** button.

   <img src='https://student-datasets-bucket.s3.ap-south-1.amazonaws.com/images/project-share-images/9_enter_project_url.png' width=800>

---
"""